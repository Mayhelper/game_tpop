<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAY GAMES</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <style>
        :root {
            --font-main: 'Oswald', sans-serif;
            --text-light: #FFFFFF;
            --btn-male: #0288D1;
            --btn-female: #D81B60;
            --color-neutral-icon: #b0b0b0;
            --active-tab-color: #4FC3F7; 
        }
        body {
            margin: 0; font-family: var(--font-main);
            min-height: 100vh; color: #2c3e50;
            transition: background-color 0.4s ease;
            background-color: #f0f2f5;
            overflow: hidden; text-transform: uppercase;
        }
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
            padding: 20px; box-sizing: border-box;
            transition: opacity 0.5s ease, transform 0.5s ease;
            opacity: 0; transform: scale(0.95); pointer-events: none;
        }
        .screen.active { opacity: 1; transform: scale(1); pointer-events: auto; }
        #screen-gender, #screen-character-select { justify-content: center; }
        
        /* --- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò --- */
        #screen-loader {
            background-image: url('https://raw.githubusercontent.com/Mayhelper/game_tpop/main/images/loader-bg.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #667eea; /* Fallback —Ü–≤–µ—Ç, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è */
            justify-content: flex-end; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤–Ω–∏–∑—É */
            align-items: center;
            z-index: 9999;
            padding-bottom: 0; /* –£–±–∏—Ä–∞–µ–º –æ—Ç—Å—Ç—É–ø, —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ –±—ã–ª–∞ –≤–Ω–∏–∑—É */
        }
        /* –ö–æ–≥–¥–∞ —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä—ã—Ç, –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        #screen-loader:not(.active) {
            z-index: -1;
        }
        #screen-loader.active {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }
        .loader-content {
            text-align: center;
            color: white;
            width: 90%;
            max-width: 350px;
            padding: 0 20px 20px 20px; /* –ù–µ–±–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Å–Ω–∏–∑—É –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ */
        }
        .loader-progress-container {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .loader-progress-bar {
            height: 100%;
            background: #E53935; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç */
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
            box-shadow: 0 0 10px rgba(229, 57, 53, 0.6);
        }
        .loader-start-button {
            width: 100%;
            padding: 16px;
            background: #E53935; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç */
            border: none;
            border-radius: 12px;
            color: white;
            font-family: var(--font-main);
            font-size: 18px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            pointer-events: none;
            transform: translateY(10px);
            box-shadow: 0 4px 15px rgba(229, 57, 53, 0.4);
        }
        .loader-start-button.visible {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0);
        }
        .loader-start-button:hover {
            background: #C62828;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(229, 57, 53, 0.6);
        }
        .loader-start-button:active {
            transform: translateY(0);
        }

        h1 { text-align: center; margin-bottom: 30px; margin-top: 10px; font-weight: 700; }
        .brand-title {
            font-size: 20px; font-weight: 400; letter-spacing: 2px;
            opacity: 0.8; margin-bottom: 0;
        }
        /* --- –≠–ö–†–ê–ù 1: –í—ã–±–æ—Ä –ø–æ–ª–∞ --- */
        body.theme-male-selection, body.theme-female-selection { color: var(--text-light); }
        body.theme-male-selection { background-color: #4FC3F7; }
        body.theme-female-selection { background-color: #F06292; }
        .gender-selection-container { display: flex; gap: 20px; margin-bottom: 40px; }
        .gender-option {
            background: rgba(255, 255, 255, 0.9); color: #2c3e50;
            border-radius: 16px; padding: 20px; text-align: center; cursor: pointer;
            border: 3px solid transparent; transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 130px;
        }
        .gender-option .image-placeholder {
            width: 80px; height: 80px; margin: 0 auto 15px;
            display: flex; align-items: center; justify-content: center; 
            font-size: 42px; font-weight: 700; color: var(--color-neutral-icon);
            background-color: #e0e0e0; border-radius: 50%;
            transition: color 0.3s ease, background-color 0.3s ease;
        }
        .gender-option:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .gender-option.active-male { border-color: var(--btn-male); }
        .gender-option.active-male .image-placeholder { color: var(--btn-male); background-color: #e3f2fd; }
        .gender-option.active-female { border-color: var(--btn-female); }
        .gender-option.active-female .image-placeholder { color: var(--btn-female); background-color: #fce4ec; }
        /* --- –ö–Ω–æ–ø–∫–∏ --- */
        .main-button {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 350px; padding: 16px; border: none; border-radius: 12px;
            font-family: var(--font-main); font-size: 18px; font-weight: 700;
            color: white; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase;
            z-index: 1000; /* –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –ø–æ–≤–µ—Ä—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        }
        #btn-confirm-gender { 
            opacity: 0 !important; 
            pointer-events: none !important; 
            transform: translate(-50%, 20px) !important;
            z-index: 1000 !important; /* –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –ø–æ–≤–µ—Ä—Ö –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
            display: block !important; /* –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è */
        }
        #btn-confirm-gender.visible { 
            opacity: 1 !important; 
            pointer-events: auto !important; 
            transform: translateX(-50%) !important;
        }
        body.theme-male-selection #btn-confirm-gender { background-color: var(--btn-male); }
        body.theme-female-selection #btn-confirm-gender { background-color: var(--btn-female); }
        /* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" –Ω–∞ —ç–∫—Ä–∞–Ω–µ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
        body.character-selection-active #btn-confirm-gender {
            display: none !important;
            opacity: 0 !important;
            pointer-events: none !important;
            visibility: hidden !important;
        }
        /* --- –≠–ö–†–ê–ù 2: –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ --- */
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(25px); } to { opacity: 1; transform: translateY(0); }
        }
        .character-info {
            width: 100%; text-align: center; padding: 0 20px; box-sizing: border-box;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4); opacity: 0;
        }
        .character-info.animate-in { opacity: 1; animation: slideInUp 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
        #character-title { font-size: 32px; font-weight: 700; min-height: 40px; margin-bottom: 5px; }
        #character-description { font-size: 16px; font-weight: 400; min-height: 40px; margin-top: 5px; letter-spacing: 0.5px; }
        .swiper { width: 100%; height: 60%; max-height: 450px; }
        .swiper-slide img { display: block; width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 10px 25px rgba(0,0,0,0.3)); }
        #btn-confirm-character { background-color: #43A047; }

        /* --- –°–¢–ò–õ–ò: –≠–ö–†–ê–ù 3 - –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è --- */
        #screen-gamification { 
            padding: 0; 
            /* –§–æ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript –∏–∑ GitHub */
            background-size: cover;
            background-position: center;
            background-color: #1a2639; /* –†–µ–∑–µ—Ä–≤–Ω—ã–π —Ü–≤–µ—Ç, –µ—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è */
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        .game-top-area {
            position: relative;
            width: 100%;
            height: 33vh;
            min-height: 200px;
            max-height: 280px;
            flex-shrink: 0;
            overflow: hidden;
        }
        .game-character-display {
            position: absolute; 
            top: 60%; /* –û–ø—É—Å–∫–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –Ω–∏–∂–µ */
            left: 50%;
            transform: translate(-50%, -50%); /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
            text-align: center; 
            width: 160px; /* –£–≤–µ–ª–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
            height: 230px; /* –£–≤–µ–ª–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
            z-index: 2; /* –ü–µ—Ä—Å–æ–Ω–∞–∂ –ø–æ–≤–µ—Ä—Ö –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        }
        .game-character-display img {
            width: 160px; /* –£–≤–µ–ª–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
            height: 230px; /* –£–≤–µ–ª–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
            object-fit: contain; /* –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ */
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
        }
        .game-character-display h2 {
            display: none; /* –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–ø–∏—Å—å –ø–æ–¥ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º */
        }
        .game-side-panel {
            position: absolute; 
            top: 20px;
            bottom: 20px;
            width: 30%;
            max-width: 110px; 
            min-width: 0;
            display: flex;
            flex-direction: column; 
            gap: 8px;
            z-index: 1;
            box-sizing: border-box;
        }
        .game-side-panel > *:last-child { margin-top: auto; }
        .panel-left { left: 10px; }
        .panel-right { right: 10px; }
        .status-bar {
            background: rgba(0, 0, 0, 0.78);
            border-radius: 10px;
            padding: 6px 8px; 
            color: white; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
            font-size: 10px;
            border: 1px solid rgba(0, 0, 0, 0.9);
            box-sizing: border-box;
        }
        .status-bar label {
            font-size: 11px; opacity: 0.95; display: flex;
            justify-content: space-between; align-items: center;
            font-weight: 400; margin-bottom: 4px;
        }
        .status-bar label span {
            font-size: 10px; font-weight: 700; background: rgba(0,0,0,0.4);
            padding: 2px 4px; border-radius: 4px;
        }
        #status-health, #status-xp, #status-gold { cursor: pointer; }
        .status-bar-icon { margin-right: 4px; opacity: 0.95; font-size: 12px; }
        #status-health .status-bar-icon { color: #E53935; }
        #status-xp .status-bar-icon { color: #7CB342; }
        #status-gold .status-bar-icon { color: #FFEB3B; }
        #status-health .bar-content { font-size: 16px; letter-spacing: 1px; }
        #status-health .bar-content span { color: #E53935; text-shadow: 0 0 5px rgba(255, 82, 82, 0.7); }
        #status-health .bar-content span.heart-empty { color: rgba(255,255,255,0.35); }
        .progress-bar-container {
            background-color: rgba(0, 0, 0, 0.3); border-radius: 5px;
            height: 10px; overflow: hidden; width: 100%;
        }
        .progress-bar-fill { background-color: #7CB342; height: 100%; border-radius: 5px; }
        #status-gold .bar-content { font-size: 13px; font-weight: 700; color: #FFEB3B; }
        .shop-button {
            width: 100%;
            padding: 10px 8px;
            background-color: rgba(0, 0, 0, 0.75);
            border-radius: 10px;
            border: 1px solid rgba(0, 0, 0, 0.9);
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            font-family: var(--font-main);
            font-size: 13px;
            font-weight: 700;
            color: white;
            text-transform: uppercase;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
        }
        .shop-button:hover {
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.02);
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            background-color: rgba(0, 0, 0, 0.85);
        }
        .shop-button:active {
            transform: scale(0.98);
        }
        .clothing-slots { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
        .clothing-slot {
            width: 100%; 
            padding-top: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            border-radius: 10px;
            border: 1px solid rgba(0, 0, 0, 0.9);
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-sizing: border-box;
        }
        .clothing-slot:hover {
            border-color: rgba(255, 255, 255, 0.4);
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        .clothing-slot img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center center;
            padding: 0;
            box-sizing: border-box;
        }
        .clothing-set-bonus {
            width: 100%;
            margin-top: 6px;
            padding: 6px 8px;
            background: rgba(0, 0, 0, 0.75);
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.9);
            font-size: 9px;
            line-height: 1.25;
            color: rgba(255, 255, 255, 0.95);
            text-transform: none;
            box-sizing: border-box;
            overflow: hidden;
            max-height: 48px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
        }
        .clothing-slot-icon {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 0;
            font-size: 28px; /* –ù–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä */
            opacity: 0.9; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è –ª—É—á—à–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ */
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); /* –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–Ω—å –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ */
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∞–≤–∏–ª –∂–∏–∑–Ω–µ–π */
        .health-rules-modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.75);
            z-index: 1000;
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .health-rules-modal.active { display: flex; }
        .health-rules-modal-content {
            background: rgba(20, 30, 48, 0.98);
            border-radius: 16px;
            padding: 24px;
            max-width: 340px;
            width: 100%;
            border: 1px solid rgba(0, 0, 0, 0.9);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .health-rules-modal h3 {
            margin: 0 0 16px 0;
            font-size: 18px;
            color: white;
            text-transform: uppercase;
        }
        .health-rules-modal p {
            margin: 0 0 12px 0;
            font-size: 14px;
            line-height: 1.5;
            color: rgba(255,255,255,0.9);
            text-transform: none;
        }
        .health-rules-modal-close {
            margin-top: 16px;
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            color: white;
            font-family: var(--font-main);
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
        }
        .info-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.75); z-index: 1000; backdrop-filter: blur(5px); align-items: center; justify-content: center; padding: 20px; box-sizing: border-box; }
        .info-modal.active { display: flex; }
        .info-modal-content { background: rgba(20, 30, 48, 0.98); border-radius: 16px; padding: 24px; max-width: 340px; width: 100%; max-height: 80vh; overflow-y: auto; border: 1px solid rgba(0,0,0,0.9); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .info-modal h3 { margin: 0 0 16px 0; font-size: 18px; color: white; text-transform: uppercase; }
        .info-modal p, .info-modal li { margin: 0 0 10px 0; font-size: 14px; line-height: 1.5; color: rgba(255,255,255,0.9); text-transform: none; }
        .info-modal ul { margin: 0 0 12px 0; padding-left: 20px; }
        .info-modal-close { margin-top: 16px; width: 100%; padding: 12px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); border-radius: 10px; color: white; font-family: var(--font-main); font-size: 14px; font-weight: 700; text-transform: uppercase; cursor: pointer; }
        .gold-history-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 13px; }
        .gold-history-item:last-child { border-bottom: none; }
        .gold-history-reason { color: rgba(255,255,255,0.9); }
        .gold-history-amount { color: #FFEB3B; font-weight: 700; }
        .gold-history-date { font-size: 11px; opacity: 0.7; margin-top: 2px; }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –æ–¥–µ–∂–¥—ã */
        .clothing-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        .clothing-modal.active {
            display: flex;
            flex-direction: column;
        }
        .clothing-modal-content {
            width: 100%;
            height: 100%;
            background: rgba(20, 30, 48, 0.95);
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
        }
        .clothing-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            color: white;
        }
        .clothing-modal-header h2 {
            margin: 0;
            font-size: 20px;
            text-transform: uppercase;
        }
        .clothing-modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .clothing-modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .clothing-modal-body {
            display: flex;
            flex: 1;
            gap: 15px;
            min-height: 0;
            align-items: flex-start;
        }
        .clothing-items-grid {
            width: 65%; /* 2/3 —ç–∫—Ä–∞–Ω–∞ */
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }
        .clothing-item {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        .clothing-item:hover:not(.locked) {
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        .clothing-item.active {
            border-color: #4FC3F7;
            box-shadow: 0 0 15px rgba(79, 195, 247, 0.5);
        }
        .clothing-item.locked {
            cursor: not-allowed;
            background: rgba(0, 0, 0, 0.5);
            border-color: rgba(255, 255, 255, 0.15);
        }
        .clothing-item.locked::after {
            content: '–∑–∞–∫—Ä—ã—Ç–æ';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
        }
        .clothing-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center center;
            display: block;
            border-radius: 10px;
        }
        .clothing-preview {
            width: 35%; /* 1/3 —ç–∫—Ä–∞–Ω–∞ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            color: white;
            padding: 12px;
            box-sizing: border-box;
        }
        .clothing-preview-image {
            width: 100%;
            max-width: 140px;
            aspect-ratio: 1;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .clothing-preview-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center center;
        }
        .clothing-preview-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
            text-align: center;
        }
        .clothing-preview-description {
            font-size: 12px;
            text-align: center;
            opacity: 0.8;
            margin-bottom: 12px;
            line-height: 1.4;
            text-transform: none;
        }
        .clothing-how-to-get {
            width: 100%;
            margin-top: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            font-size: 12px;
            line-height: 1.4;
            text-transform: none;
        }
        .clothing-how-to-get-title {
            font-weight: 700;
            margin-bottom: 6px;
            opacity: 0.95;
        }
        .clothing-how-to-get-text {
            opacity: 0.85;
        }
        .clothing-select-button {
            width: 100%;
            padding: 14px;
            background: #4FC3F7;
            border: none;
            border-radius: 12px;
            color: white;
            font-family: var(--font-main);
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .clothing-select-button:hover {
            background: #29B6F6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 195, 247, 0.4);
        }
        .clothing-select-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .clothing-remove-button {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            color: white;
            font-family: var(--font-main);
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        .clothing-remove-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        .clothing-remove-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .card-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
            touch-action: none;
            overflow: hidden;
        }
        .card-modal.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .card-modal-content {
            width: 90%;
            max-width: 400px;
            background: rgba(20, 30, 48, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-sizing: border-box;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .card-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .card-modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .card-3d-container {
            width: 100%;
            max-width: 300px;
            aspect-ratio: 3/4;
            margin: 20px 0;
            perspective: 1000px;
        }
        .card-3d {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.3s ease;
            cursor: grab;
            touch-action: none;
            -webkit-user-select: none;
            user-select: none;
        }
        .card-3d.card-3d-dragging {
            transition: none;
        }
        .card-3d:active {
            cursor: grabbing;
        }
        .card-3d-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        /* –ì–ª—è–Ω—Ü–µ–≤—ã–π –±–ª–∏–∫ ‚Äî —Ä–∞—Å—Å–µ—è–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞, —Å–º–µ—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ –∫–∞—Ä—Ç—ã */
        .card-3d-face::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            pointer-events: none;
            background: radial-gradient(
                circle at var(--gloss-x, 50%) var(--gloss-y, 50%),
                rgba(255, 255, 255, 0.4) 0%,
                rgba(255, 255, 255, 0.15) 25%,
                rgba(255, 255, 255, 0.05) 45%,
                transparent 65%
            );
        }
        
        .card-3d-face img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 15px;
        }
        .card-3d-face-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, #1a2639 0%, #2d3e50 50%, #1a2639 100%);
            border: 2px solid rgba(255, 255, 255, 0.25);
            box-shadow: inset 0 0 30px rgba(0,0,0,0.4), 0 8px 20px rgba(0,0,0,0.3);
        }
        .card-3d-face-back::before {
            content: 'MAY GAMES';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 4px;
            color: rgba(255, 255, 255, 0.5);
            text-align: center;
        }
        .card-rotation-controls {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        .card-rotation-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 8px;
            color: white;
            font-family: var(--font-main);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .card-rotation-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .card-modal-name {
            font-size: 20px;
            font-weight: 700;
            color: white;
            margin-bottom: 10px;
            text-align: center;
        }
        .card-modal-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            line-height: 1.5;
            text-transform: none;
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç–∞—Ö */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #4FC3F7, #29B6F6);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.4);
            z-index: 3000;
            font-family: var(--font-main);
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            display: none;
            animation: slideDown 0.3s ease;
        }
        .notification.active {
            display: block;
        }
        .notification-close {
            margin-left: 15px;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        .notification-close:hover {
            opacity: 1;
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
        
        /* --- –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ë–õ–û–ö –í–ö–õ–ê–î–û–ö --- */
        #tabs-container {
            position: relative;
            width: 100%;
            flex: 1;
            min-height: 0;
            background: rgba(20, 30, 48, 0.85);
            backdrop-filter: blur(10px);
            border-top-left-radius: 30px;
            border-top-right-radius: 30px;
            padding: 20px 15px 15px 15px;
            padding-top: 30px;
            box-sizing: border-box;
            color: white;
            display: none;
            box-shadow: 0 -10px 25px rgba(0,0,0,0.5);
            overflow: hidden;
            margin-top: 16px;
        }
        .tab-buttons {
            display: flex; gap: 5px; background: rgba(0, 0, 0, 0.25);
            border-radius: 14px; padding: 5px; box-sizing: border-box;
            margin-bottom: 15px;
        }
        .tab-button {
            flex: 1; background: none; border: none;
            color: rgba(255, 255, 255, 0.7); font-family: var(--font-main);
            font-size: 16px; text-transform: uppercase; padding: 10px 0;
            cursor: pointer; border-radius: 10px; transition: all 0.3s ease;
        }
        .tab-button.active {
            color: white; font-weight: 700;
            background-color: var(--active-tab-color);
        }
        .tabs-content { 
            height: calc(100% - 70px); /* –£–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ */
            min-height: 0; /* –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∂–∏–º–∞—Ç—å—Å—è */
            overflow: hidden;
            padding-top: 5px; /* –ù–µ–±–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
        }
        .tab-pane {
            display: none; height: 100%;
            align-items: center; justify-content: center;
        }
        .tab-pane.active { display: flex; }
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            width: 100%;
            height: 100%;
            padding: 10px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        .card-item {
            aspect-ratio: 3/4;
            background: 
                linear-gradient(135deg, rgba(245, 245, 220, 0.15) 0%, rgba(250, 240, 230, 0.1) 100%),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 0, 0, 0.03) 2px,
                    rgba(0, 0, 0, 0.03) 4px
                ),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 0, 0, 0.03) 2px,
                    rgba(0, 0, 0, 0.03) 4px
                ),
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
            background-color: rgba(245, 245, 220, 0.2);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            border: 2px solid rgba(139, 120, 100, 0.3);
            box-shadow: 
                0 2px 8px rgba(0,0,0,0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }
        .card-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 40%, rgba(255, 255, 255, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 70% 60%, rgba(255, 255, 255, 0.05) 0%, transparent 40%);
            pointer-events: none;
            opacity: 0.6;
        }
        .card-item:hover {
            transform: scale(1.05);
            border-color: rgba(139, 120, 100, 0.5);
            box-shadow: 
                0 4px 12px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.15);
        }
        .card-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center center;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            border-radius: 10px;
        }
        .card-item-name {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            color: white;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 2;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.6) 70%, transparent 100%);
            padding: 8px 6px 6px 6px;
            width: 100%;
            box-sizing: border-box;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        /* –ï–¥–∏–Ω—ã–π –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
        .no-image-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            font-size: 12px;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.6);
            text-align: center;
            padding: 10px;
            box-sizing: border-box;
            text-transform: none;
        }
        .no-image-placeholder.small {
            font-size: 10px;
            padding: 4px;
        }
        
        .badges-swiper { 
            width: 100%; 
            height: 100%; 
            padding: 5px 0;
        }
        .badges-swiper .swiper-slide {
            background: rgba(255, 255, 255, 0.1); 
            border-radius: 12px;
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-size: 14px; 
            font-weight: bold;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .badges-swiper .swiper-slide {
            height: 80px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –∑–Ω–∞—á–∫–æ–≤ */
            aspect-ratio: 1; /* –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –∑–Ω–∞—á–∫–∏ */
            font-size: 32px; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä —ç–º–æ–¥–∑–∏ */
        }
        #achievements-list {
            list-style: none; 
            padding: 0 5px; 
            margin: 0; 
            width: 100%;
            font-size: 14px; 
            text-transform: none; 
            text-align: left;
            height: 100%; 
            overflow-y: auto;
            -webkit-overflow-scrolling: touch; /* –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –Ω–∞ iOS */
        }
        #achievements-list li { padding: 8px 10px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        #achievements-list li:last-child { border-bottom: none; }
        
        /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-height: 600px) {
            .game-top-area {
                height: 35vh; /* –ù–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
                min-height: 180px;
            }
            /* –ü–µ—Ä—Å–æ–Ω–∞–∂ –æ—Å—Ç–∞–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ */
            .status-bar {
                padding: 6px;
                font-size: 10px;
            }
            .cards-swiper .swiper-slide {
                height: 90px; /* –ù–µ–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
            }
            .badges-swiper .swiper-slide {
                height: 70px;
            }
        }
        
        @media (max-width: 360px) {
            .game-side-panel {
                max-width: 90px; /* –£–º–µ–Ω—å—à–∞–µ–º –ø–∞–Ω–µ–ª–∏ –Ω–∞ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
            }
            /* –ü–µ—Ä—Å–æ–Ω–∞–∂ –æ—Å—Ç–∞–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ */
            .cards-swiper .swiper-slide {
                height: 85px;
                font-size: 12px;
            }
            .badges-swiper .swiper-slide {
                height: 65px;
                font-size: 28px;
            }
        }
    </style>
</head>
<body>

    <!-- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò -->
    <div id="screen-loader" class="screen active">
        <div class="loader-content">
            <div class="loader-progress-container">
                <div class="loader-progress-bar" id="loader-progress-bar"></div>
            </div>
            <button class="loader-start-button" id="loader-start-button" onclick="startGame()">–ù–∞—á–∞—Ç—å</button>
        </div>
    </div>

    <div id="screen-gender" class="screen">
        <!-- ... (—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->
        <h2 class="brand-title">MAY GAMES</h2>
        <h1>–°–î–ï–õ–ê–ô –í–´–ë–û–†</h1>
        <div class="gender-selection-container">
            <div class="gender-option" id="btn-male" onclick="selectGender('male')">
                <div class="image-placeholder">‚ôÇ</div><h3>–ú–£–ñ–ß–ò–ù–ê</h3>
            </div>
            <div class="gender-option" id="btn-female" onclick="selectGender('female')">
                <div class="image-placeholder">‚ôÄ</div><h3>–ñ–ï–ù–©–ò–ù–ê</h3>
            </div>
        </div>
    </div>

    <div id="screen-character-select" class="screen">
        <!-- ... (—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->
        <div id="character-title" class="character-info"></div>
        <div class="swiper">
            <div class="swiper-wrapper" id="character-swiper-wrapper"></div>
            <div class="swiper-pagination"></div>
        </div>
        <div id="character-description" class="character-info"></div>
    </div>

    <div id="screen-gamification" class="screen">
        <div class="game-top-area">
            <div class="game-character-display">
                <img id="game-character-image" src="" alt="Character">
            </div>
            <div class="game-side-panel panel-left">
                <!-- ... (—Å—Ç–∞—Ç—É—Å-–±–∞—Ä—ã) ... -->
                 <div class="status-bar" id="status-health" onclick="openHealthRulesModal()" title="–ü—Ä–∞–≤–∏–ª–∞ –∂–∏–∑–Ω–µ–π">
                    <label><span class="status-bar-icon">‚ù§</span> –∂–∏–∑–Ω–∏</label>
                    <div class="bar-content"><span>‚ù§</span><span>‚ù§</span><span class="heart-empty">ü§ç</span></div>
                </div>
                <div class="status-bar" id="status-xp" onclick="openXpModal()" title="–ó–∞ —á—Ç–æ –¥–∞—ë—Ç—Å—è –æ–ø—ã—Ç">
                    <label><span class="status-bar-icon">‚≠ê</span> –æ–ø—ã—Ç <span>Level 5</span></label>
                    <div class="bar-content"><div class="progress-bar-container"><div class="progress-bar-fill" style="width: 60%;"></div></div></div>
                </div>
                <div class="status-bar" id="status-gold" onclick="openGoldModal()" title="–ò—Å—Ç–æ—Ä–∏—è May Coins">
                    <label><span class="status-bar-icon">ü™ô</span> May Coins</label>
                    <div class="bar-content">ü™ô 1250</div>
                </div>
            </div>
            <div class="game-side-panel panel-right">
                <button class="shop-button" onclick="openShop()">–ú–ê–ì–ê–ó–ò–ù</button>
                <div class="clothing-slots">
                    <div class="clothing-slot" data-slot-type="head" onclick="openClothingModal('head')">
                        <div class="clothing-slot-icon">üë§</div>
                    </div>
                    <div class="clothing-slot" data-slot-type="body" onclick="openClothingModal('body')">
                        <div class="clothing-slot-icon">üëï</div>
                    </div>
                    <div class="clothing-slot" data-slot-type="legs" onclick="openClothingModal('legs')">
                        <div class="clothing-slot-icon">üëñ</div>
                    </div>
                    <div class="clothing-slot" data-slot-type="shoes" onclick="openClothingModal('shoes')">
                        <div class="clothing-slot-icon">üëü</div>
                    </div>
                </div>
                <div class="clothing-set-bonus" id="clothing-set-bonus">‚Äî</div>
            </div>
        </div>
        
        <div id="tabs-container">
            <div class="tab-buttons">
                <button class="tab-button active" data-color="#4FC3F7" onclick="switchTab('cards', this)">–ö–∞—Ä—Ç–æ—á–∫–∏</button>
                <button class="tab-button" data-color="#F06292" onclick="switchTab('badges', this)">–ó–Ω–∞—á–∫–∏</button>
                <button class="tab-button" data-color="#7CB342" onclick="switchTab('achievements', this)">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
            </div>
            <div class="tabs-content">
                <div id="tab-cards" class="tab-pane active">
                    <div class="cards-grid" id="cards-grid"></div>
                </div>
                <div id="tab-badges" class="tab-pane">
                    <div class="swiper-container badges-swiper"><div class="swiper-wrapper" id="badges-swiper-wrapper"></div></div>
                </div>
                <div id="tab-achievements" class="tab-pane">
                    <ul id="achievements-list"></ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∞–≤–∏–ª –∂–∏–∑–Ω–µ–π -->
    <div id="health-rules-modal" class="health-rules-modal" onclick="if(event.target===this) closeHealthRulesModal()">
        <div class="health-rules-modal-content">
            <h3>–ü—Ä–∞–≤–∏–ª–∞ –∂–∏–∑–Ω–µ–π</h3>
            <p>–ï—Å–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –Ω–µ –∑–∞—Ö–æ–¥–∏—Ç –≤ –∏–≥—Ä—É –≤ —Ç–µ—á–µ–Ω–∏–µ <strong>2 –¥–Ω–µ–π</strong>, –∂–∏–∑–Ω–∏ —Ç–µ—Ä—è—é—Ç—Å—è (–æ–¥–Ω–æ —Å–µ—Ä–¥—Ü–µ –≤ –¥–µ–Ω—å).</p>
            <p>–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∂–∏–∑–Ω–µ–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è <strong>May Coins</strong> –≤ —Ä–∞–∑–º–µ—Ä–µ <strong>200 –º–æ–Ω–µ—Ç</strong>.</p>
            <button type="button" class="health-rules-modal-close" onclick="closeHealthRulesModal()">–ü–æ–Ω—è—Ç–Ω–æ</button>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–ø—ã—Ç–∞ -->
    <div id="xp-modal" class="info-modal" onclick="if(event.target===this) closeXpModal()">
        <div class="info-modal-content">
            <h3>‚≠ê –ó–∞ —á—Ç–æ –¥–∞—ë—Ç—Å—è –æ–ø—ã—Ç</h3>
            <p>–û–ø—ã—Ç –ø–æ–≤—ã—à–∞–µ—Ç –≤–∞—à —É—Ä–æ–≤–µ–Ω—å –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –û—á–∫–∏ –æ–ø—ã—Ç–∞ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∑–∞:</p>
            <ul>
                <li><strong>–ö–∞—Ä—Ç–æ—á–∫–∏</strong> ‚Äî –∑–∞ –∫–∞–∂–¥—É—é –Ω–æ–≤—É—é –æ—Ç–∫—Ä—ã—Ç—É—é –∫–∞—Ä—Ç–æ—á–∫—É (+10 XP)</li>
                <li><strong>–ó–Ω–∞—á–∫–∏</strong> ‚Äî –∑–∞ –∫–∞–∂–¥—ã–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∑–Ω–∞—á–æ–∫ (+5 XP)</li>
                <li><strong>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</strong> ‚Äî –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (+15‚Äì50 XP –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)</li>
                <li><strong>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥</strong> ‚Äî –∑–∞ –≤—Ö–æ–¥ –≤ –∏–≥—Ä—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å (+3 XP)</li>
                <li><strong>–ö–æ–º–ø–ª–µ–∫—Ç –æ–¥–µ–∂–¥—ã</strong> ‚Äî –∑–∞ –ø–æ–ª–Ω—ã–π —Å–æ–±—Ä–∞–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç (+20 XP)</li>
            </ul>
            <p>–ß–µ–º –≤—ã—à–µ —É—Ä–æ–≤–µ–Ω—å, —Ç–µ–º –±–æ–ª—å—à–µ –±–æ–Ω—É—Å–æ–≤ –∏ –Ω–∞–≥—Ä–∞–¥.</p>
            <button type="button" class="info-modal-close" onclick="closeXpModal()">–ü–æ–Ω—è—Ç–Ω–æ</button>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ May Coins -->
    <div id="gold-modal" class="info-modal" onclick="if(event.target===this) closeGoldModal()">
        <div class="info-modal-content">
            <h3>ü™ô May Coins ‚Äî –∫–æ–≥–¥–∞ –∏ –∑–∞ —á—Ç–æ</h3>
            <p>–ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏ —Å–ø–∏—Å–∞–Ω–∏—è –º–æ–Ω–µ—Ç.</p>
            <div id="gold-history-list">
                <div class="gold-history-item">
                    <div><span class="gold-history-reason">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ –≤—Ö–æ–¥</span><div class="gold-history-date">–°–µ–≥–æ–¥–Ω—è, 10:30</div></div>
                    <span class="gold-history-amount">+50</span>
                </div>
                <div class="gold-history-item">
                    <div><span class="gold-history-reason">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ ¬´–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏¬ª</span><div class="gold-history-date">–í—á–µ—Ä–∞</div></div>
                    <span class="gold-history-amount">+100</span>
                </div>
                <div class="gold-history-item">
                    <div><span class="gold-history-reason">–û—Ç–∫—Ä—ã—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∞</span><div class="gold-history-date">28 —è–Ω–≤</div></div>
                    <span class="gold-history-amount">+30</span>
                </div>
                <div class="gold-history-item">
                    <div><span class="gold-history-reason">–ü–æ–∫—É–ø–∫–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ</span><div class="gold-history-date">27 —è–Ω–≤</div></div>
                    <span class="gold-history-amount">‚àí200</span>
                </div>
            </div>
            <button type="button" class="info-modal-close" onclick="closeGoldModal()">–ü–æ–Ω—è—Ç–Ω–æ</button>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –æ–¥–µ–∂–¥—ã -->
    <div id="clothing-modal" class="clothing-modal">
        <div class="clothing-modal-content">
            <div class="clothing-modal-header">
                <h2 id="clothing-modal-title">–í—ã–±–æ—Ä –æ–¥–µ–∂–¥—ã</h2>
                <button class="clothing-modal-close" onclick="closeClothingModal()">√ó</button>
            </div>
            <div class="clothing-modal-body">
                <div class="clothing-items-grid" id="clothing-items-grid">
                    <!-- –í–µ—â–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                <div class="clothing-preview">
                    <div class="clothing-preview-image" id="clothing-preview-image">
                        <span style="opacity: 0.5;">–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—â—å</span>
                    </div>
                    <div class="clothing-preview-name" id="clothing-preview-name">-</div>
                    <div class="clothing-preview-description" id="clothing-preview-description">-</div>
                    <div class="clothing-how-to-get" id="clothing-how-to-get">
                        <div class="clothing-how-to-get-title">–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å</div>
                        <div class="clothing-how-to-get-text" id="clothing-how-to-get-text">‚Äî</div>
                    </div>
                    <button class="clothing-select-button" id="clothing-select-button" onclick="selectClothingItem()" disabled>–í—ã–±—Ä–∞—Ç—å</button>
                    <button class="clothing-remove-button" id="clothing-remove-button" onclick="removeClothingItem()" disabled>–°–Ω—è—Ç—å</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <div id="card-modal" class="card-modal">
        <div class="card-modal-content">
            <button class="card-modal-close" onclick="closeCardModal()">√ó</button>
            <div class="card-modal-name" id="card-modal-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã</div>
            <div class="card-3d-container">
                <div class="card-3d" id="card-3d">
                    <div class="card-3d-face card-3d-face-front">
                        <img id="card-3d-image" src="" alt="Card">
                    </div>
                    <div class="card-3d-face card-3d-face-back"></div>
                </div>
            </div>
            <div class="card-rotation-controls">
                <button class="card-rotation-btn" onclick="rotateCard('left')">‚Üê –ü–æ–≤–µ—Ä–Ω—É—Ç—å</button>
                <button class="card-rotation-btn" onclick="rotateCard('right')">–ü–æ–≤–µ—Ä–Ω—É—Ç—å ‚Üí</button>
            </div>
            <div class="card-modal-description" id="card-modal-description">–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã</div>
        </div>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç–∞—Ö -->
    <div id="notification" class="notification">
        <span>–£ –≤–∞—Å –Ω–æ–≤—ã–µ –∫–∞—Ä—Ç—ã, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ!</span>
        <span class="notification-close" onclick="closeNotification()">√ó</span>
    </div>
    
    <button id="btn-confirm-gender" class="main-button" onclick="goToCharacterSelection()">–î–∞–ª–µ–µ</button>
    <button id="btn-confirm-character" class="main-button" style="display: none;" onclick="confirmCharacter()">–í—ã–±—Ä–∞—Ç—å</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let selectedGender = null;
        let swiperInstance = null;
        let selectedCharacter = {};
        let badgesSwiperInstance = null;
        let areTabsInitialized = false;

        const AppData = {
            repoUrl: 'https://raw.githubusercontent.com/Mayhelper/game_tpop/main/images/',
            loaderBackground: 'loader-bg.png', // –§–æ–Ω–æ–≤–∞—è –∑–∞—Å—Ç–∞–≤–∫–∞ –¥–ª—è —ç–∫—Ä–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
            characters: { 
                male: [
                    { id: 'male-1', bg: '#039BE5', title: '–í–°–ï–ì–î–ê –° –ò–ì–û–õ–û–ß–ö–ò', description: '–ì–û–¢–û–í –ü–û–ö–û–†–ò–¢–¨ –õ–Æ–ë–´–ï –¢–û–ß–ö–ò' },
                    { id: 'male-2', bg: '#FF6F00', title: '–î–£–®–ê –ö–û–ú–ü–ê–ù–ò–ò', description: '–ù–ê–•–û–î–ò–¢ –û–ë–©–ò–ô –Ø–ó–´–ö –° –ö–ï–ú –£–ì–û–î–ù–û' },
                    { id: 'male-3', bg: '#00897B', title: '–ö–†–ï–ê–¢–ò–í–ù–´–ô –ì–ï–ù–ò–ô', description: '–ú–´–°–õ–ò–¢ –ù–ï–°–¢–ê–ù–î–ê–†–¢–ù–û –ò –ü–û–õ–û–ù –ò–î–ï–ô' },
                    { id: 'male-4', bg: '#5E35B1', title: '–ü–†–ò–†–û–ñ–î–ï–ù–ù–´–ô –õ–ò–î–ï–†', description: '–í–ï–î–ï–¢ –ö–û–ú–ê–ù–î–£ –ö –ù–û–í–´–ú –í–ï–†–®–ò–ù–ê–ú' },
                    { id: 'male-5', bg: '#3949AB', title: '–ú–ê–°–¢–ï–† –°–í–û–ï–ì–û –î–ï–õ–ê', description: '–ó–ù–ê–ï–¢ –í–°–ï –¢–û–ù–ö–û–°–¢–ò –£–°–ü–ï–•–ê' },
                ],
                female: [
                    { id: 'female-1', bg: '#D81B60', title: '–ó–í–ï–ó–î–ê –ü–ï–†–ï–ì–û–í–û–†–û–í', description: '–£–ë–ï–î–ò–¢ –ö–û–ì–û –£–ì–û–î–ù–û –ò –ó–ê–ö–õ–Æ–ß–ò–¢ –°–î–ï–õ–ö–£' },
                    { id: 'female-2', bg: '#1E88E5', title: '–ú–ò–°–° –≠–õ–ï–ì–ê–ù–¢–ù–û–°–¢–¨', description: '–°–û–ß–ï–¢–ê–ï–¢ –°–¢–ò–õ–¨, –£–ú –ò –î–ï–õ–û–í–£–Æ –•–í–ê–¢–ö–£' },
                    { id: 'female-3', bg: '#7CB342', title: '–ì–ï–ù–ï–†–ê–¢–û–† –ò–î–ï–ô', description: '–ï–ï –ö–†–ï–ê–¢–ò–í–ù–û–°–¢–¨ –ù–ï –ó–ù–ê–ï–¢ –ì–†–ê–ù–ò–¶' },
                    { id: 'female-4', bg: '#E53935', title: '–ü–†–ò–ù–¶–ï–°–°–ê –í–†–ï–ú–ï–ù–ò', description: '–£–°–ü–ï–í–ê–ï–¢ –í–°–ï –ò –î–ê–ñ–ï –ë–û–õ–¨–®–ï' },
                    { id: 'female-5', bg: '#8E24AA', title: '–ö–û–†–û–õ–ï–í–ê –õ–ò–î–ï–†–°–¢–í–ê', description: '–°–¢–†–û–ò–¢ –ü–†–û–ß–ù–´–ï –ú–û–°–¢–´ –ú–ï–ñ–î–£ –õ–Æ–î–¨–ú–ò' },
                ]
            },
            cards: [
                { id: 'card-1', name: '–ö–∞—Ä—Ç–∞ 1', description: '–ú–æ—â–Ω–∞—è –∫–∞—Ä—Ç–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã. –î–∞–µ—Ç –±–æ–Ω—É—Å –∫ –æ–ø—ã—Ç—É.', image: 'cards/card-1.png', glowColor: 'silver' },
                { id: 'card-2', name: '–ö–∞—Ä—Ç–∞ 2', description: '–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å –æ—Å–æ–±—ã–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏. –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ.', image: 'cards/card-2.png' },
                { id: 'card-3', name: '–ö–∞—Ä—Ç–∞ 3', description: '–†–µ–¥–∫–∞—è –∫–∞—Ä—Ç–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–∞. –ü–æ–≤—ã—à–∞–µ—Ç —É–¥–∞—á—É.', image: 'cards/card-3.png' },
                { id: 'card-4', name: '–ö–∞—Ä—Ç–∞ 4', description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞. –î–∞–µ—Ç –æ–≥—Ä–æ–º–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.', image: 'cards/card-4.png', glowColor: 'gold' },
                { id: 'card-5', name: '–ö–∞—Ä—Ç–∞ 5', description: '–≠–ø–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.', image: 'cards/card-5.png', glowColor: 'purple' },
                { id: 'card-6', name: '–ö–∞—Ä—Ç–∞ 6', description: '–ù–æ–≤–∞—è –∫–∞—Ä—Ç–∞! –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.', image: 'cards/card-6.png' }
            ],
            badges: [
                { text: '‚≠ê' }, { text: 'üèÜ' }, { text: 'üíé' }, { text: 'üí°' }, { text: 'üöÄ' }
            ],
            achievements: [
                { text: '‚úÖ –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏: –ó–∞–≤–µ—Ä—à–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ' }, { text: '‚úÖ –ù–æ–≤–∞—Ç–æ—Ä: –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å 5 –∏–¥–µ–π' },
                { text: 'üîí –ö–æ–º–∞–Ω–¥–Ω—ã–π –∏–≥—Ä–æ–∫: –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç' }, { text: 'üîí –õ–∏–¥–µ—Ä –º–Ω–µ–Ω–∏–π: –í—ã—Å—Ç—É–ø–∏—Ç—å –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ' },
            ],
            clothing: {
                // –ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –æ–¥–µ–∂–¥—ã –Ω–∞ GitHub: clothing/{—Ç–∏–ø}/{id}.png
                // howToGet ‚Äî —Ç–µ–∫—Å—Ç ¬´–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å¬ª –≤–µ—â—å
                head: [
                    { id: 'chain-gold', name: '–ó–æ–ª–æ—Ç–∞—è —Ü–µ–ø–æ—á–∫–∞', description: '–¢–æ–Ω–∫–∏–π –∞–∫—Ü–µ–Ω—Ç –¥–µ–ª–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞', image: 'clothing/head/chain-gold.png', howToGet: '–ü–æ—Å–µ—Ç–∏—Ç—å 10 –∑–∞–ø—Ä–∞–≤–æ–∫ –ø–∞—Ä—Ç–Ω—ë—Ä–∞' },
                    { id: 'cap-90', name: '–ë–µ–π—Å–±–æ–ª–∫–∞ —Å —Å–∏–º–≤–æ–ª–∏–∫–æ–π', description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π —Å—Ç–∏–ª—å –¥–µ–≤—è–Ω–æ—Å—Ç—ã—Ö', image: 'clothing/head/cap-90.png', howToGet: '–ü–æ—Å–µ—Ç–∏—Ç—å 5 –≥–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–æ–≤' },
                    { id: 'hat-spy', name: '–®–ª—è–ø–∞ —à–ø–∏–æ–Ω–∞', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —à–ª—è–ø–∞ –¥–ª—è —Å—Ç–∏–ª—è –¥–µ—Ç–µ–∫—Ç–∏–≤–∞', image: 'clothing/head/hat-spy.png', howToGet: '–°–æ–±—Ä–∞—Ç—å 3 –∫–∞—Ä—Ç—ã –∏–∑ –æ–¥–Ω–æ–π —Å–µ—Ä–∏–∏' },
                    { id: 'cap-1', name: '–ë–µ–π—Å–±–æ–ª–∫–∞', description: '–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á', image: 'clothing/head/cap-1.png', howToGet: '–î–æ—Å—Ç–∏—á—å 5 —É—Ä–æ–≤–Ω—è' },
                    { id: 'helmet-1', name: '–ö–∞—Å–∫–∞', description: '–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ —Å—Ç—Ä–æ–π–∫–µ', image: 'clothing/head/helmet-1.png', howToGet: '–í—ã–ø–æ–ª–Ω–∏—Ç—å 5 –∑–∞–∫–∞–∑–æ–≤' },
                ],
                body: [
                    { id: 'suit-office', name: '–û—Ñ–∏—Å–Ω—ã–π –∫–æ—Å—Ç—é–º', description: '–ë–µ–∑—É–ø—Ä–µ—á–Ω—ã–π –∫—Ä–æ–π –¥–ª—è –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤ –∏ –∫–∞—Ä—å–µ—Ä—ã', image: 'clothing/body/suit-office.png', howToGet: '–ü–æ–ª—É—á–∏—Ç—å 500 May Coins' },
                    { id: 'jacket-sport', name: '–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –∫—É—Ä—Ç–∫–∞', description: '–í–µ—Ç–µ—Ä –¥–µ–≤—è–Ω–æ—Å—Ç—ã—Ö –≤ –∫–∞–∂–¥–æ–º —à–≤–µ', image: 'clothing/body/jacket-sport.png', howToGet: '–ü–æ—Å–µ—Ç–∏—Ç—å 7 –ê–ó–° –≤ –æ–¥–Ω–æ–º –º–µ—Å—è—Ü–µ' },
                    { id: 'coat-spy', name: '–ü–∞–ª—å—Ç–æ —à–ø–∏–æ–Ω–∞', description: '–î–ª–∏–Ω–Ω–æ–µ –ø–∞–ª—å—Ç–æ –¥–ª—è –Ω–µ–∑–∞–º–µ—Ç–Ω–æ—Å—Ç–∏', image: 'clothing/body/coat-spy.png', howToGet: '–î–æ—Å—Ç–∏—á—å 10 —É—Ä–æ–≤–Ω—è –æ–ø—ã—Ç–∞' },
                    { id: 'shirt-1', name: '–†—É–±–∞—à–∫–∞', description: '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Ä—É–±–∞—à–∫–∞', image: 'clothing/body/shirt-1.png', howToGet: '–ü–æ—Å–µ—Ç–∏—Ç—å 3 –º–∞–≥–∞–∑–∏–Ω–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞' },
                    { id: 'hoodie-1', name: '–¢–æ–ª—Å—Ç–æ–≤–∫–∞', description: '–ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å', image: 'clothing/body/hoodie-1.png', howToGet: '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞' },
                ],
                legs: [
                    { id: 'skirt-pencil', name: '–Æ–±–∫–∞-–∫–∞—Ä–∞–Ω–¥–∞—à', description: '–ö–ª–∞—Å—Å–∏–∫–∞ –æ—Ñ–∏—Å–Ω–æ–≥–æ —Å—Ç–∏–ª—è –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏', image: 'clothing/legs/skirt-pencil.png', howToGet: '–í—ã–ø–æ–ª–Ω–∏—Ç—å 5 –∑–∞–∫–∞–∑–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏' },
                    { id: 'pants-sport', name: '–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —à—Ç–∞–Ω—ã', description: '–†–∞—Å—Å–ª–∞–±–ª–µ–Ω–Ω—ã–π –¥—É—Ö —ç–ø–æ—Ö–∏ 90-—Ö', image: 'clothing/legs/pants-sport.png', howToGet: '–ü–æ—Å–µ—Ç–∏—Ç—å 3 —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞' },
                    { id: 'pants-spy', name: '–®—Ç–∞–Ω—ã —à–ø–∏–æ–Ω–∞', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —à—Ç–∞–Ω—ã –ø–æ–¥ –ø–∞–ª—å—Ç–æ', image: 'clothing/legs/pants-spy.png', howToGet: '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å 10 –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤' },
                    { id: 'jeans-1', name: '–î–∂–∏–Ω—Å—ã', description: '–£–¥–æ–±–Ω—ã–µ –¥–∂–∏–Ω—Å—ã', image: 'clothing/legs/jeans-1.png', howToGet: '–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å 500 May Coins' },
                    { id: 'shorts-1', name: '–®–æ—Ä—Ç—ã', description: '–î–ª—è –∂–∞—Ä–∫–æ–π –ø–æ–≥–æ–¥—ã', image: 'clothing/legs/shorts-1.png', howToGet: '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É' },
                ],
                shoes: [
                    { id: 'heels', name: '–¢—É—Ñ–ª–∏ –Ω–∞ –∫–∞–±–ª—É–∫–µ', description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π —à–∞–≥ –∫ —É—Å–ø–µ—Ö—É', image: 'clothing/shoes/heels.png', howToGet: '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å 20 –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤' },
                    { id: 'sneakers-white', name: '–ë–µ–ª—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏', description: '–ß–∏—Å—Ç—ã–π —Ä–µ—Ç—Ä–æ-–≤–∏–¥, –∫–∞–∫ –≤ –ª—É—á—à–∏–µ –≥–æ–¥—ã', image: 'clothing/shoes/sneakers-white.png', howToGet: '–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å 1000 May Coins' },
                    { id: 'boots-black', name: '–ß–µ—Ä–Ω—ã–µ –±–æ—Ç–∏–Ω–∫–∏', description: '–°—Ç—Ä–æ–≥–∏–µ —á–µ—Ä–Ω—ã–µ –±–æ—Ç–∏–Ω–∫–∏ –¥–ª—è –æ–±—Ä–∞–∑–∞ —à–ø–∏–æ–Ω–∞', image: 'clothing/shoes/boots-black.png', howToGet: '–ü–æ—Å–µ—Ç–∏—Ç—å 15 –∑–∞–ø—Ä–∞–≤–æ–∫ –∑–∞ –º–µ—Å—è—Ü' },
                    { id: 'sneakers-1', name: '–ö—Ä–æ—Å—Å–æ–≤–∫–∏', description: '–£–¥–æ–±–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏', image: 'clothing/shoes/sneakers-1.png', howToGet: '–î–æ—Å—Ç–∏—á—å 8 —É—Ä–æ–≤–Ω—è' },
                    { id: 'boots-1', name: '–ë–æ—Ç–∏–Ω–∫–∏', description: '–ù–∞–¥–µ–∂–Ω—ã–µ –±–æ—Ç–∏–Ω–∫–∏', image: 'clothing/shoes/boots-1.png', howToGet: '–í—ã–ø–æ–ª–Ω–∏—Ç—å 10 –∑–∞–∫–∞–∑–æ–≤' },
                ]
            },
            // –ö–æ–º–ø–ª–µ–∫—Ç—ã: 0=–æ—Ñ–∏—Å, 1=90-—Ö, 2=—à–ø–∏–æ–Ω. –ë–µ–∑ –∫–æ—Å—Ç—é–º–∞ ‚Äî character id (female-1, male-1‚Ä¶), –≤ –∫–æ—Å—Ç—é–º–µ ‚Äî character.1, character.2, character.3
            outfitSets: [
                { id: 'office', name: '–û—Ñ–∏—Å–Ω—ã–π —Å—Ç–∏–ª—å', head: 'chain-gold', body: 'suit-office', legs: 'skirt-pencil', shoes: 'heels', bonus: '–ë–æ–Ω—É—Å: +15% –∫ May Coins –≤ –±—É–¥–Ω–∏. –û–±—Ä–∞–∑ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—â–∏–∫–∞ –∏ –ª–∏–¥–µ—Ä–∞.' },
                { id: 'style90', name: '–°—Ç–∏–ª—å 90-—Ö', head: 'cap-90', body: 'jacket-sport', legs: 'pants-sport', shoes: 'sneakers-white', bonus: '–ë–æ–Ω—É—Å: +10% –∫ –æ–ø—ã—Ç—É. –ù–æ—Å—Ç–∞–ª—å–≥–∏—è –∏ —É–≤–µ—Ä–µ–Ω–Ω—ã–π —É–ª–∏—á–Ω—ã–π —Å—Ç–∏–ª—å.' },
                { id: 'spy', name: '–®–ø–∏–æ–Ω', head: 'hat-spy', body: 'coat-spy', legs: 'pants-spy', shoes: 'boots-black', bonus: '–ë–æ–Ω—É—Å: +12% –∫ –æ–ø—ã—Ç—É. –°—Ç–∏–ª—å –¥–µ—Ç–µ–∫—Ç–∏–≤–∞ –∏ —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç–∏.' },
                { id: 'business', name: '–î–µ–ª–æ–≤–æ–π', head: null, body: 'shirt-1', legs: 'jeans-1', shoes: 'boots-1', bonus: '–ë–æ–Ω—É—Å: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è.' }
            ]
        };
        
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–¥–µ–∂–¥—ã
        let selectedClothing = {
            head: null,
            body: null,
            legs: null,
            shoes: null
        };
        
        let currentClothingType = null;
        let currentSelectedClothingItem = null;
        
        // --- –§–£–ù–ö–¶–ò–Ø –ü–†–ï–î–ó–ê–ì–†–£–ó–ö–ò –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô ---
        function preloadImages() {
            // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ–Ω–æ–≤—É—é –∑–∞—Å—Ç–∞–≤–∫—É
            if (AppData.loaderBackground) {
                const bgImage = new Image();
                bgImage.src = AppData.repoUrl + AppData.loaderBackground;
                bgImage.onload = function() {
                    const loaderScreen = document.getElementById('screen-loader');
                    loaderScreen.style.background = `url('${AppData.repoUrl}${AppData.loaderBackground}') center/cover, linear-gradient(135deg, #667eea 0%, #764ba2 100%)`;
                };
            }
            
            const imagesToLoad = [];
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
            Object.values(AppData.characters.male).forEach(char => {
                imagesToLoad.push(AppData.repoUrl + char.id + '.png');
            });
            Object.values(AppData.characters.female).forEach(char => {
                imagesToLoad.push(AppData.repoUrl + char.id + '.png');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ–Ω
            imagesToLoad.push(AppData.repoUrl + 'game-bg.png');
            
            // –í–∞—Ä–∏–∞–Ω—Ç—ã –≤ –∫–æ—Å—Ç—é–º–∞—Ö: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ .1, .2, .3, .4 –ø–æ —á–∏—Å–ª—É –∫–æ–º–ø–ª–µ–∫—Ç–æ–≤
            const outfitCount = (AppData.outfitSets && AppData.outfitSets.length) || 4;
            ['male', 'female'].forEach(g => {
                (AppData.characters[g] || []).forEach(char => {
                    for (let v = 1; v <= outfitCount; v++) {
                        imagesToLoad.push(AppData.repoUrl + char.id + '.' + v + '.png');
                    }
                });
            });
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–¥–µ–∂–¥—ã
            Object.values(AppData.clothing).forEach(category => {
                category.forEach(item => {
                    imagesToLoad.push(AppData.repoUrl + item.image);
                });
            });
            
            let loadedCount = 0;
            const totalImages = imagesToLoad.length;
            const progressBar = document.getElementById('loader-progress-bar');
            
            // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            function updateProgress() {
                const percentage = Math.round((loadedCount / totalImages) * 100);
                progressBar.style.width = percentage + '%';
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const loadPromises = imagesToLoad.map((url, index) => {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.onload = () => {
                        loadedCount++;
                        updateProgress();
                        resolve(url);
                    };
                    img.onerror = () => {
                        // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–∞–∂–µ –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å
                        loadedCount++;
                        updateProgress();
                        resolve(url); // –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–æ–º–∏—Å, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
                    };
                    img.src = url;
                });
            });
            
            // –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            Promise.all(loadPromises).then(() => {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞—á–∞—Ç—å"
                const startButton = document.getElementById('loader-start-button');
                startButton.classList.add('visible');
            });
        }
        
        // --- (JS-–∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ª–æ–≥–∏–∫–µ) ---
        const bodyEl = document.body;
        const screens = { 
            gender: document.getElementById('screen-gender'), 
            character: document.getElementById('screen-character-select'),
            gamification: document.getElementById('screen-gamification')
        };
        const buttons = { 
            confirmGender: document.getElementById('btn-confirm-gender'), 
            confirmCharacter: document.getElementById('btn-confirm-character'), 
            male: document.getElementById('btn-male'), female: document.getElementById('btn-female') 
        };
        const characterInfo = { 
            title: document.getElementById('character-title'), 
            description: document.getElementById('character-description') 
        };

        function selectGender(gender) {
            console.log('selectGender called with:', gender);
            selectedGender = gender;
            bodyEl.className = '';
            if (buttons.male) buttons.male.classList.remove('active-male');
            if (buttons.female) buttons.female.classList.remove('active-female');
            if (gender === 'male') {
                bodyEl.classList.add('theme-male-selection');
                if (buttons.male) buttons.male.classList.add('active-male');
            } else {
                bodyEl.classList.add('theme-female-selection');
                if (buttons.female) buttons.female.classList.add('active-female');
            }
            if (buttons.confirmGender) {
                console.log('Adding visible class to confirm button');
                buttons.confirmGender.classList.add('visible');
                console.log('Button classes:', buttons.confirmGender.className);
            } else {
                console.error('Confirm gender button not found');
            }
        }

        function goToCharacterSelection() {
            if (!selectedGender) return;
            const characterList = AppData.characters[selectedGender];
            const swiperWrapper = document.getElementById('character-swiper-wrapper');
            if (!swiperWrapper) {
                console.error('Swiper wrapper not found');
                return;
            }
            swiperWrapper.innerHTML = '';
            characterList.forEach(char => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                slide.innerHTML = `<img src="${AppData.repoUrl + char.id + '.png'}" alt="${char.title}">`;
                swiperWrapper.appendChild(slide);
            });
            screens.gender.classList.remove('active');
            // –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
            if (buttons.confirmGender) {
                buttons.confirmGender.style.display = 'none';
                buttons.confirmGender.classList.remove('visible');
                buttons.confirmGender.style.opacity = '0';
            }
            screens.character.classList.add('active');
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –Ω–∞ body –¥–ª—è CSS –ø—Ä–∞–≤–∏–ª
            bodyEl.classList.add('character-selection-active');
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–í—ã–±—Ä–∞—Ç—å —ç—Ç–æ–≥–æ"
            if (buttons.confirmCharacter) {
                buttons.confirmCharacter.style.display = 'block';
            }
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Swiper –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ —ç–∫—Ä–∞–Ω–∞
            setTimeout(() => {
                initSwiper();
            }, 100);
        }

        function initSwiper() {
            if (swiperInstance) {
                try {
                    swiperInstance.destroy(true, true);
                } catch(e) {
                    console.warn('Error destroying swiper:', e);
                }
            }
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä –¥–ª—è —ç–∫—Ä–∞–Ω–∞ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
            const swiperElement = screens.character ? screens.character.querySelector('.swiper') : null;
            if (!swiperElement) {
                console.error('Swiper element not found in character screen');
                return;
            }
            const paginationElement = swiperElement.querySelector('.swiper-pagination');
            if (!paginationElement) {
                console.error('Pagination element not found');
                return;
            }
            try {
                swiperInstance = new Swiper(swiperElement, {
                    effect: 'fade', 
                    fadeEffect: { crossFade: true },
                    grabCursor: true, 
                    loop: true,
                    pagination: { el: paginationElement, dynamicBullets: true },
                    on: {
                        slideChangeTransitionStart: () => {
                            if (characterInfo.title) characterInfo.title.classList.remove('animate-in');
                            if (characterInfo.description) characterInfo.description.classList.remove('animate-in');
                        },
                        slideChangeTransitionEnd: () => updateCharacterInfo(),
                        init: () => setTimeout(updateCharacterInfo, 100),
                    },
                });
            } catch(e) {
                console.error('Error initializing Swiper:', e);
            }
        }
        
        function updateCharacterInfo() {
            if (!swiperInstance || !selectedGender) return;
            const activeIndex = swiperInstance.realIndex;
            const currentCharacter = AppData.characters[selectedGender][activeIndex];
            bodyEl.style.backgroundColor = currentCharacter.bg;
            characterInfo.title.textContent = currentCharacter.title;
            characterInfo.description.textContent = currentCharacter.description;
            characterInfo.title.classList.add('animate-in');
            characterInfo.description.classList.add('animate-in');
            selectedCharacter = currentCharacter;
        }

        function confirmCharacter() {
            if (!selectedCharacter) return;
            document.getElementById('game-character-image').src = AppData.repoUrl + selectedCharacter.id + '.png';
            document.getElementById('game-character-image').alt = selectedCharacter.title;
            // –ü–æ–¥–ø–∏—Å—å –ø–æ–¥ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º —É–±—Ä–∞–Ω–∞
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω –∏–∑ GitHub
            const screenGamification = document.getElementById('screen-gamification');
            screenGamification.style.backgroundImage = `url('${AppData.repoUrl}game-bg.png')`;
            
            screens.character.classList.remove('active');
            // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å —Å body
            bodyEl.classList.remove('character-selection-active');
            screens.gamification.classList.add('active');
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–í—ã–±—Ä–∞—Ç—å —ç—Ç–æ–≥–æ"
            if (buttons.confirmCharacter) {
                buttons.confirmCharacter.style.display = 'none';
            }
            
            document.getElementById('tabs-container').style.display = 'block';
            
            if (!areTabsInitialized) initGameTabs();
            applyOutfitSet(0);
        }

        function initGameTabs() {
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ grid - —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã, –±–µ–∑ –ø—É—Å—Ç—ã—Ö —Å–ª–æ—Ç–æ–≤
            const cardsGrid = document.getElementById('cards-grid');
            if (cardsGrid) {
                cardsGrid.innerHTML = '';
                AppData.cards.forEach(card => {
                    const cardItem = document.createElement('div');
                    cardItem.className = 'card-item';
                    cardItem.onclick = () => openCardModal(card);
                    cardItem.innerHTML = `
                        <img src="${AppData.repoUrl + card.image}" alt="${card.name}" onerror="var n=this.alt; this.style.display='none'; this.parentElement.innerHTML='<div class=\'no-image-placeholder\' style=\'position:absolute;top:0;left:0;right:0;bottom:0;z-index:1\'>–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div><div class=\'card-item-name\'>'+n+'</div>'">
                        <div class="card-item-name">${card.name}</div>
                    `;
                    // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–∞—Ä—Ç–æ—á–∫–∞ –∏–º–µ–µ—Ç position: relative –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                    cardItem.style.position = 'relative';
                    cardsGrid.appendChild(cardItem);
                });
            }
            
            const badgesWrapper = document.getElementById('badges-swiper-wrapper');
            AppData.badges.forEach(badge => {
                badgesWrapper.innerHTML += `<div class="swiper-slide">${badge.text}</div>`;
            });
            const achievementsList = document.getElementById('achievements-list');
            AppData.achievements.forEach(ach => {
                achievementsList.innerHTML += `<li>${ach.text}</li>`;
            });

            badgesSwiperInstance = new Swiper('.badges-swiper', {
                slidesPerView: 4.5, /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º 4.5 –∑–Ω–∞—á–∫–∞ */
                spaceBetween: 8, 
                loop: false, /* –û—Ç–∫–ª—é—á–∞–µ–º loop, —Ç–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–∫–æ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
                grabCursor: true,
                freeMode: true, /* –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ */
            });
            areTabsInitialized = true;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç–∞—Ö
            setTimeout(() => {
                showNotification();
            }, 1000);
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
        let currentCardRotation = { x: 0, y: 0 };
        let currentCard = null;
        let cardModalDragHandlers = null;
        
        function openCardModal(card) {
            currentCard = card;
            currentCardRotation = { x: 0, y: 0 };
            const modal = document.getElementById('card-modal');
            const cardName = document.getElementById('card-modal-name');
            const cardDescription = document.getElementById('card-modal-description');
            const card3d = document.getElementById('card-3d');
            const card3dFace = card3d.querySelector('.card-3d-face-front');
            
            cardName.textContent = card.name;
            cardDescription.textContent = card.description;
            
            if (card3dFace) {
                card3dFace.innerHTML = '<img id="card-3d-image" src="" alt="Card">';
            }
            const cardImg = document.getElementById('card-3d-image');
            if (cardImg) {
                cardImg.src = AppData.repoUrl + card.image;
                cardImg.alt = card.name;
                cardImg.onerror = function() {
                    if (card3dFace) {
                        card3dFace.innerHTML = '<div class="no-image-placeholder">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>';
                    }
                };
            }
            
            card3d.style.transform = 'rotateX(0deg) rotateY(0deg)';
            updateCardGloss(card3d);
            card3d.classList.remove('card-3d-dragging');
            
            if (card3dFace) {
                card3dFace.classList.remove('glow-silver', 'glow-gold', 'glow-blue', 'glow-purple');
            }
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            document.body.style.position = 'fixed';
            document.body.style.width = '100%';
            
            let isDragging = false;
            let startX = 0;
            let startY = 0;
            
            const handleMouseDown = (e) => {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                card3d.classList.add('card-3d-dragging');
                e.preventDefault();
            };
            
            const handleTouchStart = (e) => {
                if (e.touches.length === 1) {
                    isDragging = true;
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                    card3d.classList.add('card-3d-dragging');
                    e.preventDefault();
                }
            };
            
            const handleMove = (clientX, clientY) => {
                if (!isDragging) return;
                const deltaX = clientX - startX;
                const deltaY = clientY - startY;
                currentCardRotation.y += deltaX * 0.5;
                currentCardRotation.x -= deltaY * 0.5;
                currentCardRotation.x = Math.max(-30, Math.min(30, currentCardRotation.x));
                card3d.style.transform = `rotateX(${currentCardRotation.x}deg) rotateY(${currentCardRotation.y}deg)`;
                updateCardGloss(card3d);
                startX = clientX;
                startY = clientY;
            };
            
            const handleMouseMove = (e) => {
                if (isDragging) {
                    handleMove(e.clientX, e.clientY);
                    e.preventDefault();
                }
            };
            
            const handleTouchMove = (e) => {
                if (isDragging && e.touches[0]) {
                    handleMove(e.touches[0].clientX, e.touches[0].clientY);
                    e.preventDefault();
                }
            };
            
            const handleEnd = () => { 
                isDragging = false;
                card3d.classList.remove('card-3d-dragging');
            };
            
            card3d.addEventListener('mousedown', handleMouseDown);
            card3d.addEventListener('touchstart', handleTouchStart, { passive: false });
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('mouseup', handleEnd);
            document.addEventListener('touchend', handleEnd);
            document.addEventListener('touchcancel', handleEnd);
            
            cardModalDragHandlers = {
                mouseDown: handleMouseDown,
                touchStart: handleTouchStart,
                mouseMove: handleMouseMove,
                touchMove: handleTouchMove,
                end: handleEnd
            };
            
            if (tg && tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
        }
        
        function closeCardModal() {
            const modal = document.getElementById('card-modal');
            const card3d = document.getElementById('card-3d');
            if (card3d) card3d.classList.remove('card-3d-dragging');
            if (cardModalDragHandlers && card3d) {
                card3d.removeEventListener('mousedown', cardModalDragHandlers.mouseDown);
                card3d.removeEventListener('touchstart', cardModalDragHandlers.touchStart);
                document.removeEventListener('mousemove', cardModalDragHandlers.mouseMove);
                document.removeEventListener('touchmove', cardModalDragHandlers.touchMove);
                document.removeEventListener('mouseup', cardModalDragHandlers.end);
                document.removeEventListener('touchend', cardModalDragHandlers.end);
                document.removeEventListener('touchcancel', cardModalDragHandlers.end);
                cardModalDragHandlers = null;
            }
            modal.classList.remove('active');
            currentCard = null;
            document.body.style.overflow = '';
            document.body.style.position = '';
            document.body.style.width = '';
        }
        
        function rotateCard(direction) {
            const card3d = document.getElementById('card-3d');
            if (!card3d) return;
            
            if (direction === 'left') {
                currentCardRotation.y -= 15;
            } else {
                currentCardRotation.y += 15;
            }
            
            card3d.style.transform = `rotateX(${currentCardRotation.x}deg) rotateY(${currentCardRotation.y}deg)`;
            updateCardGloss(card3d);
        }
        
        function updateCardGloss(card3dEl) {
            if (!card3dEl) return;
            var glossX = 50 + currentCardRotation.y * 0.25;
            var glossY = 50 - currentCardRotation.x * 0.25;
            glossX = Math.max(15, Math.min(85, glossX));
            glossY = Math.max(15, Math.min(85, glossY));
            card3dEl.style.setProperty('--gloss-x', glossX + '%');
            card3dEl.style.setProperty('--gloss-y', glossY + '%');
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification() {
            const notification = document.getElementById('notification');
            if (notification) {
                notification.classList.add('active');
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    closeNotification();
                }, 5000);
            }
        }
        
        function closeNotification() {
            const notification = document.getElementById('notification');
            if (notification) {
                notification.classList.remove('active');
            }
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        document.getElementById('card-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCardModal();
            }
        });

        function switchTab(tabId, clickedButton) {
            document.documentElement.style.setProperty('--active-tab-color', clickedButton.dataset.color);
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
            clickedButton.classList.add('active');
            document.getElementById(`tab-${tabId}`).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ badges swiper, —Ç–∞–∫ –∫–∞–∫ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ–ø–µ—Ä—å –≤ grid
            if (tabId === 'badges' && badgesSwiperInstance) badgesSwiperInstance.update();
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–¥–µ–∂–¥–æ–π
        function openShop() {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
            }
            alert('–ú–∞–≥–∞–∑–∏–Ω —Å–∫–æ—Ä–æ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è!');
        }
        
        function openHealthRulesModal() {
            const modal = document.getElementById('health-rules-modal');
            if (modal) modal.classList.add('active');
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
            }
        }
        function closeHealthRulesModal() {
            const modal = document.getElementById('health-rules-modal');
            if (modal) modal.classList.remove('active');
        }
        
        function openXpModal() {
            const modal = document.getElementById('xp-modal');
            if (modal) modal.classList.add('active');
            if (window.Telegram && window.Telegram.WebApp) window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
        }
        function closeXpModal() {
            const modal = document.getElementById('xp-modal');
            if (modal) modal.classList.remove('active');
        }
        
        function openGoldModal() {
            const modal = document.getElementById('gold-modal');
            if (modal) modal.classList.add('active');
            if (window.Telegram && window.Telegram.WebApp) window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
        }
        function closeGoldModal() {
            const modal = document.getElementById('gold-modal');
            if (modal) modal.classList.remove('active');
        }
        
        function openClothingModal(type) {
            currentClothingType = type;
            const modal = document.getElementById('clothing-modal');
            const title = document.getElementById('clothing-modal-title');
            const grid = document.getElementById('clothing-items-grid');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            const typeNames = {
                head: '–ì–æ–ª–æ–≤–∞',
                body: '–¢—É–ª–æ–≤–∏—â–µ',
                legs: '–ù–æ–≥–∏',
                shoes: '–û–±—É–≤—å'
            };
            title.textContent = `–í—ã–±–æ—Ä: ${typeNames[type]}`;
            
            // –û—á–∏—â–∞–µ–º —Å–µ—Ç–∫—É
            grid.innerHTML = '';
            
            // –ü–æ–ª—É—á–∞–µ–º –≤–µ—â–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞
            const items = AppData.clothing[type] || [];
            const totalSlots = 9;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤–µ—â–∏ –≤ —Å–µ—Ç–∫—É (–¥–æ 9 —Å–ª–æ—Ç–æ–≤)
            for (let i = 0; i < totalSlots; i++) {
                const itemDiv = document.createElement('div');
                if (i < items.length) {
                    const item = items[i];
                    itemDiv.className = 'clothing-item';
                    itemDiv.onclick = (e) => selectClothingItemPreview(item, itemDiv);
                    if (selectedClothing[type] && selectedClothing[type].id === item.id) {
                        itemDiv.classList.add('active');
                    }
                    const img = document.createElement('img');
                    img.src = AppData.repoUrl + item.image;
                    img.alt = item.name;
                    img.onerror = function() {
                        this.style.display = 'none';
                        itemDiv.innerHTML = `<div class="no-image-placeholder">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>`;
                    };
                    itemDiv.appendChild(img);
                } else {
                    itemDiv.className = 'clothing-item locked';
                }
                grid.appendChild(itemDiv);
            }
            
            // –ï—Å–ª–∏ –≤–µ—â—å —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë –≤ –ø—Ä–µ–≤—å—é –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ç–∫–∏
            setTimeout(() => {
                if (selectedClothing[type]) {
                    const selectedItem = selectedClothing[type];
                    const previewImage = document.getElementById('clothing-preview-image');
                    const previewName = document.getElementById('clothing-preview-name');
                    const previewDescription = document.getElementById('clothing-preview-description');
                    const selectButton = document.getElementById('clothing-select-button');
                    const removeButton = document.getElementById('clothing-remove-button');
                    
                    previewImage.innerHTML = `<img src="${AppData.repoUrl + selectedItem.image}" alt="${selectedItem.name}">`;
                    previewName.textContent = selectedItem.name;
                    previewDescription.textContent = selectedItem.description;
                    const howToGetEl = document.getElementById('clothing-how-to-get-text');
                    if (howToGetEl) howToGetEl.textContent = selectedItem.howToGet || '‚Äî';
                    selectButton.disabled = false;
                    if (removeButton) {
                        removeButton.disabled = false;
                    }
                    
                    // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–µ—Ç–∫–µ –∏ –¥–µ–ª–∞–µ–º –µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã–º
                    const activeItem = Array.from(grid.children).find(child => {
                        const img = child.querySelector('img');
                        return img && img.alt === selectedItem.name;
                    });
                    if (activeItem) {
                        activeItem.classList.add('active');
                    }
                } else {
                    resetClothingPreview();
                }
            }, 50);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            modal.classList.add('active');
        }
        
        function closeClothingModal() {
            const modal = document.getElementById('clothing-modal');
            modal.classList.remove('active');
            currentSelectedClothingItem = null;
        }
        
        function selectClothingItemPreview(item, element) {
            currentSelectedClothingItem = item;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–µ—Ç–∫–µ
            document.querySelectorAll('.clothing-item').forEach(el => el.classList.remove('active'));
            if (element) {
                element.classList.add('active');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–≤—å—é
            const previewImage = document.getElementById('clothing-preview-image');
            const previewName = document.getElementById('clothing-preview-name');
            const previewDescription = document.getElementById('clothing-preview-description');
            const selectButton = document.getElementById('clothing-select-button');
            const removeButton = document.getElementById('clothing-remove-button');
            
            previewImage.innerHTML = `<img src="${AppData.repoUrl + item.image}" alt="${item.name}" onerror="this.parentElement.innerHTML='<div class=\'no-image-placeholder\'>–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>'">`;
            previewName.textContent = item.name;
            previewDescription.textContent = item.description;
            const howToGetEl = document.getElementById('clothing-how-to-get-text');
            if (howToGetEl) howToGetEl.textContent = item.howToGet || '‚Äî';
            selectButton.disabled = false;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–°–Ω—è—Ç—å" –µ—Å–ª–∏ —ç—Ç–∞ –≤–µ—â—å —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞
            const isCurrentlySelected = selectedClothing[currentClothingType] && selectedClothing[currentClothingType].id === item.id;
            if (removeButton) {
                removeButton.disabled = !isCurrentlySelected;
            }
        }
        
        function resetClothingPreview() {
            const previewImage = document.getElementById('clothing-preview-image');
            const previewName = document.getElementById('clothing-preview-name');
            const previewDescription = document.getElementById('clothing-preview-description');
            const selectButton = document.getElementById('clothing-select-button');
            const removeButton = document.getElementById('clothing-remove-button');
            
            previewImage.innerHTML = '<span style="opacity: 0.5;">–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—â—å</span>';
            previewName.textContent = '-';
            previewDescription.textContent = '-';
            const howToGetEl = document.getElementById('clothing-how-to-get-text');
            if (howToGetEl) howToGetEl.textContent = '‚Äî';
            selectButton.disabled = true;
            if (removeButton) {
                removeButton.disabled = true;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–Ω—è—Ç–∏—è –≤–µ—â–∏
        function removeClothingItem() {
            if (!currentClothingType) return;
            
            // –£–¥–∞–ª—è–µ–º –≤–µ—â—å –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
            selectedClothing[currentClothingType] = null;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–æ—Ç - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–∫–æ–Ω–∫—É
            const slot = document.querySelector(`[data-slot-type="${currentClothingType}"]`);
            if (slot) {
                slot.innerHTML = `<div class="clothing-slot-icon">${getSlotIcon(currentClothingType)}</div>`;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
            updateCharacterImage();
            updateClothingSetDescription();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–°–Ω—è—Ç—å" –≤ –ø—Ä–µ–≤—å—é
            const removeButton = document.getElementById('clothing-remove-button');
            if (removeButton) {
                removeButton.disabled = true;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å–µ—Ç–∫–µ
            document.querySelectorAll('.clothing-item').forEach(el => el.classList.remove('active'));
            
            // –í–∏–±—Ä–∞—Ü–∏—è
            if (tg && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }
        
        function selectClothingItem() {
            if (!currentSelectedClothingItem || !currentClothingType) return;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–µ—â—å
            selectedClothing[currentClothingType] = currentSelectedClothingItem;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–æ—Ç
            const slot = document.querySelector(`[data-slot-type="${currentClothingType}"]`);
            if (slot) {
                slot.innerHTML = `<img src="${AppData.repoUrl + currentSelectedClothingItem.image}" alt="${currentSelectedClothingItem.name}" onerror="this.parentElement.innerHTML='<div class=\'no-image-placeholder small\'>–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>'">`;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏—é —Å–∞–º—É—Ä–∞—è –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
            updateCharacterImage();
            updateClothingSetDescription();
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É "–°–Ω—è—Ç—å"
            const removeButton = document.getElementById('clothing-remove-button');
            if (removeButton) {
                removeButton.disabled = false;
            }
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeClothingModal();
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
            if (tg && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('medium');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        // –ë–µ–∑ –∫–æ—Å—Ç—é–º–∞: female-1, male-1 –∏ —Ç.–¥. –í –∫–æ—Å—Ç—é–º–µ: female-1.1, male-2.2 –∏ —Ç.–¥. (–≤—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏)
        function updateCharacterImage() {
            const characterImage = document.getElementById('game-character-image');
            if (!characterImage || !selectedCharacter) return;
            
            const set = getCurrentOutfitSet();
            if (set && AppData.outfitSets) {
                const setIndex = AppData.outfitSets.indexOf(set);
                if (setIndex >= 0) {
                    const variant = setIndex + 1;
                    characterImage.src = AppData.repoUrl + selectedCharacter.id + '.' + variant + '.png';
                    characterImage.alt = selectedCharacter.title + ' (' + (set.name || '–ö–æ–º–ø–ª–µ–∫—Ç ' + variant) + ')';
                    return;
                }
            }
            characterImage.src = AppData.repoUrl + selectedCharacter.id + '.png';
            characterImage.alt = selectedCharacter.title;
        }
        
        function getSlotIcon(type) {
            const icons = {
                head: 'üë§',
                body: 'üëï',
                legs: 'üëñ',
                shoes: 'üëü'
            };
            return icons[type] || 'üëï';
        }
        
        function getClothingItem(type, itemId) {
            const list = AppData.clothing[type];
            if (!list) return null;
            return list.find(item => item.id === itemId) || null;
        }
        
        function getCurrentOutfitSet() {
            if (!AppData.outfitSets) return null;
            for (const set of AppData.outfitSets) {
                const headOk = (set.head == null && selectedClothing.head == null) || (set.head && selectedClothing.head && selectedClothing.head.id === set.head);
                const bodyOk = (set.body == null && selectedClothing.body == null) || (set.body && selectedClothing.body && selectedClothing.body.id === set.body);
                const legsOk = (set.legs == null && selectedClothing.legs == null) || (set.legs && selectedClothing.legs && selectedClothing.legs.id === set.legs);
                const shoesOk = (set.shoes == null && selectedClothing.shoes == null) || (set.shoes && selectedClothing.shoes && selectedClothing.shoes.id === set.shoes);
                if (headOk && bodyOk && legsOk && shoesOk) return set;
            }
            return null;
        }
        
        function updateClothingSetDescription() {
            const el = document.getElementById('clothing-set-bonus');
            if (!el) return;
            const set = getCurrentOutfitSet();
            el.textContent = set ? set.bonus : '–°–æ–±–µ—Ä–∏—Ç–µ –∫–æ–º–ø–ª–µ–∫—Ç ‚Äî –±–æ–Ω—É—Å –∑–∞ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä.';
        }
        
        function refreshClothingSlots() {
            const types = ['head', 'body', 'legs', 'shoes'];
            types.forEach(type => {
                const slot = document.querySelector(`[data-slot-type="${type}"]`);
                if (!slot) return;
                const item = selectedClothing[type];
                if (item) {
                    slot.innerHTML = `<img src="${AppData.repoUrl + item.image}" alt="${item.name}" onerror="this.parentElement.innerHTML='<div class=\'no-image-placeholder small\'>–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>'">`;
                } else {
                    slot.innerHTML = `<div class="clothing-slot-icon">${getSlotIcon(type)}</div>`;
                }
            });
        }
        
        function applyOutfitSet(setIndex) {
            if (!AppData.outfitSets || setIndex < 0 || setIndex >= AppData.outfitSets.length) return;
            const set = AppData.outfitSets[setIndex];
            selectedClothing.head = set.head ? getClothingItem('head', set.head) : null;
            selectedClothing.body = set.body ? getClothingItem('body', set.body) : null;
            selectedClothing.legs = set.legs ? getClothingItem('legs', set.legs) : null;
            selectedClothing.shoes = set.shoes ? getClothingItem('shoes', set.shoes) : null;
            refreshClothingSlots();
            updateCharacterImage();
            updateClothingSetDescription();
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        document.getElementById('clothing-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeClothingModal();
            }
        });
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        function startGame() {
            const loaderScreen = document.getElementById('screen-loader');
            const genderScreen = document.getElementById('screen-gender');
            
            if (!loaderScreen || !genderScreen) {
                console.error('–≠–∫—Ä–∞–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!');
                return;
            }
            
            loaderScreen.classList.remove('active');
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            setTimeout(() => {
                loaderScreen.style.display = 'none';
            }, 500);
            
            setTimeout(() => {
                genderScreen.classList.add('active');
                console.log('–≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ –ø–æ–ª–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
            }, 300);
        }
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω–æ–≤—É—é –∑–∞—Å—Ç–∞–≤–∫—É —Å—Ä–∞–∑—É
            if (AppData.loaderBackground) {
                const loaderScreen = document.getElementById('screen-loader');
                const bgUrl = AppData.repoUrl + AppData.loaderBackground;
                loaderScreen.style.background = `url('${bgUrl}') center/cover no-repeat, linear-gradient(135deg, #667eea 0%, #764ba2 100%)`;
                
                // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                const bgImage = new Image();
                bgImage.src = bgUrl;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –Ω–∞–π–¥–µ–Ω—ã
            if (!buttons.confirmGender) {
                console.error('–ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
            }
            if (!buttons.male || !buttons.female) {
                console.error('–ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–æ–ª–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!');
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            preloadImages();
        });
    </script>
</body>
</html>